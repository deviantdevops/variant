{"id":"J1zk","dependencies":[{"name":"/home/hibberdk/Sites/XILOBYTE/variant/package.json","includedInParent":true,"mtime":1626001361021},{"name":"crypto-js","loc":{"line":1,"column":25},"parent":"/home/hibberdk/Sites/XILOBYTE/variant/client/src/utilities/crypt.js","resolved":"/home/hibberdk/Sites/XILOBYTE/variant/node_modules/crypto-js/index.js"},{"name":"tweetnacl","loc":{"line":2,"column":21},"parent":"/home/hibberdk/Sites/XILOBYTE/variant/client/src/utilities/crypt.js","resolved":"/home/hibberdk/Sites/XILOBYTE/variant/node_modules/tweetnacl/nacl-fast.js"},{"name":"tweetnacl-util","loc":{"line":3,"column":21},"parent":"/home/hibberdk/Sites/XILOBYTE/variant/client/src/utilities/crypt.js","resolved":"/home/hibberdk/Sites/XILOBYTE/variant/node_modules/tweetnacl-util/nacl-util.js"}],"generated":{"js":"var global = arguments[3];\nvar e=arguments[3];function t(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=require(\"crypto-js\"),c=require(\"tweetnacl\"),a=require(\"tweetnacl-util\"),i=function(){function r(){t(this,r)}return n(r,null,[{key:\"hash\",value:function(e){return o.SHA384(JSON.stringify(e)).toString()}},{key:\"create\",value:function(){var t={},r=c.box.keyPair();return t.publicKey=\"\".concat(e.config.ADDRESS_PREFIX).concat(this.byteArrayToHex(r.publicKey)),t.privateKey=\"\".concat(e.config.ADDRESS_PREFIX).concat(this.byteArrayToHex(r.secretKey)),t}},{key:\"nonce\",value:function(){return c.randomBytes(c.secretbox.nonceLength)}},{key:\"sign\",value:function(e){var t=e.payload,r=e.publicKey;\"string\"!=typeof t&&(t=JSON.stringify(t));var n,o,i,y,u,s={};try{n=a.decodeUTF8(t),o=c.hash(n),i=this.nonce(),y=this.hexToByteArray(r),u=c.secretbox(o,i,y)}catch(l){console.log(l)}return s.signature=this.byteArrayToHex(u),s.nonce=this.byteArrayToHex(i),s}},{key:\"verify\",value:function(e){var t=e.signature,r=e.nonce,n=e.publicKey,o=!1;try{var a=this.hexToByteArray(r),i=this.hexToByteArray(t),y=this.hexToByteArray(n);o=c.secretbox.open(i,a,y)}catch(u){return!1}return!1!==o}},{key:\"encrypt\",value:function(e,t,r){var n=c.randomBytes(c.secretbox.nonceLength),o=this.hexToByteArray(t),i=this.hexToByteArray(r),y=a.decodeUTF8(e),u=c.box(y,n,o,i),s=new Uint8Array(n.length+u.length);return s.set(n),s.set(u,n.length),a.encodeBase64(s)}},{key:\"decrypt\",value:function(e,t,r){var n=a.decodeBase64(e),o=n.slice(0,c.box.nonceLength),i=n.slice(c.box.nonceLength,e.length),y=this.hexToByteArray(t),u=this.hexToByteArray(r),s=c.box.open(i,o,u,y);if(!s)throw new Error(\"Could not decrypt message\");return a.encodeUTF8(s)}},{key:\"byteArrayToHex\",value:function(e){return Array.prototype.map.call(e,function(e){return(\"0\"+(255&e).toString(16)).slice(-2)}).join(\"\")}},{key:\"hexToByteArray\",value:function(t){var r=[];t.substr(0,e.config.ADDRESS_PREFIX.length)===e.config.ADDRESS_PREFIX&&(t=t.substr(e.config.ADDRESS_PREFIX.length));for(var n=0;n<t.length;n+=2)r.push(parseInt(t.substr(n,2),16));return new Uint8Array(r)}},{key:\"decodePublicKey\",value:function(e){try{var t=a.decodeBase64(e);return t.length!=c.box.publicKeyLength?(this.error(\"Bad public key length: must be \"+c.box.publicKeyLength+\" bytes\"),null):t}catch(r){return this.error(\"Failed to decode public key from Base64\"),null}}},{key:\"decodeSecretKey\",value:function(e){try{var t=a.decodeBase64(e);return t.length!=c.box.secretKeyLength?(this.error(\"Bad secret key length: must be \"+c.box.secretKeyLength+\" bytes\"),null):t}catch(r){return this.error(\"Failed to decode secret key from Base64\"),null}}}]),r}();module.exports=i;"},"sourceMaps":{"js":{"mappings":[{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":0}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":4}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":6}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":16}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":19}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":28}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":30}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":32}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":35}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":40}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":53}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":56}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":62}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":66}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":76}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":113}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":122}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":124}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":126}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":129}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":133}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":137}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":139}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":141}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":143}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":145}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":152}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":156}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":157}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":161}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":163}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":165}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":168}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":170}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":181}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":183}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":196}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":198}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":200}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":214}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":216}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":226}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":230}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":232}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":242}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":245}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":252}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":267}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":269}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":271}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":275}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":279}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":288}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":290}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":292}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":294}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":297}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":304}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":307}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":309}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":311}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":321}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":324}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":327}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":329}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":331}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":334}},{"source":"utilities/crypt.js","original":{"line":1,"column":0},"generated":{"line":2,"column":336}},{"source":"utilities/crypt.js","name":"CryptoJS","original":{"line":1,"column":6},"generated":{"line":2,"column":340}},{"source":"utilities/crypt.js","name":"require","original":{"line":1,"column":17},"generated":{"line":2,"column":342}},{"source":"utilities/crypt.js","original":{"line":1,"column":25},"generated":{"line":2,"column":350}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":2,"column":6},"generated":{"line":2,"column":363}},{"source":"utilities/crypt.js","name":"require","original":{"line":2,"column":13},"generated":{"line":2,"column":365}},{"source":"utilities/crypt.js","original":{"line":2,"column":21},"generated":{"line":2,"column":373}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":3,"column":6},"generated":{"line":2,"column":386}},{"source":"utilities/crypt.js","name":"require","original":{"line":3,"column":13},"generated":{"line":2,"column":388}},{"source":"utilities/crypt.js","original":{"line":3,"column":21},"generated":{"line":2,"column":396}},{"source":"utilities/crypt.js","name":"Crypt","original":{"line":5,"column":6},"generated":{"line":2,"column":414}},{"source":"utilities/crypt.js","name":"Crypt","original":{"line":5,"column":6},"generated":{"line":2,"column":416}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":427}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":436}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":440}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":442}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":447}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":450}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":457}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":459}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":461}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":466}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":467}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":468}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":472}},{"source":"utilities/crypt.js","original":{"line":7,"column":4},"generated":{"line":2,"column":479}},{"source":"utilities/crypt.js","original":{"line":7,"column":4},"generated":{"line":2,"column":485}},{"source":"utilities/crypt.js","name":"payload","original":{"line":7,"column":17},"generated":{"line":2,"column":494}},{"source":"utilities/crypt.js","name":"CryptoJS","original":{"line":8,"column":15},"generated":{"line":2,"column":497}},{"source":"utilities/crypt.js","name":"CryptoJS","original":{"line":8,"column":15},"generated":{"line":2,"column":504}},{"source":"utilities/crypt.js","name":"SHA384","original":{"line":8,"column":24},"generated":{"line":2,"column":506}},{"source":"utilities/crypt.js","name":"JSON","original":{"line":8,"column":32},"generated":{"line":2,"column":513}},{"source":"utilities/crypt.js","name":"stringify","original":{"line":8,"column":37},"generated":{"line":2,"column":518}},{"source":"utilities/crypt.js","name":"payload","original":{"line":8,"column":48},"generated":{"line":2,"column":528}},{"source":"utilities/crypt.js","name":"toString","original":{"line":8,"column":59},"generated":{"line":2,"column":532}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":545}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":546}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":550}},{"source":"utilities/crypt.js","original":{"line":11,"column":4},"generated":{"line":2,"column":559}},{"source":"utilities/crypt.js","original":{"line":11,"column":4},"generated":{"line":2,"column":565}},{"source":"utilities/crypt.js","name":"keys","original":{"line":12,"column":12},"generated":{"line":2,"column":576}},{"source":"utilities/crypt.js","name":"keys","original":{"line":12,"column":12},"generated":{"line":2,"column":580}},{"source":"utilities/crypt.js","original":{"line":12,"column":19},"generated":{"line":2,"column":582}},{"source":"utilities/crypt.js","name":"pair","original":{"line":13,"column":12},"generated":{"line":2,"column":585}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":13,"column":19},"generated":{"line":2,"column":587}},{"source":"utilities/crypt.js","name":"box","original":{"line":13,"column":24},"generated":{"line":2,"column":589}},{"source":"utilities/crypt.js","name":"keyPair","original":{"line":13,"column":28},"generated":{"line":2,"column":593}},{"source":"utilities/crypt.js","name":"keys","original":{"line":16,"column":15},"generated":{"line":2,"column":603}},{"source":"utilities/crypt.js","name":"keys","original":{"line":14,"column":8},"generated":{"line":2,"column":610}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":14,"column":13},"generated":{"line":2,"column":612}},{"source":"utilities/crypt.js","name":"global","original":{"line":14,"column":28},"generated":{"line":2,"column":622}},{"source":"utilities/crypt.js","name":"global","original":{"line":14,"column":28},"generated":{"line":2,"column":625}},{"source":"utilities/crypt.js","name":"global","original":{"line":14,"column":28},"generated":{"line":2,"column":632}},{"source":"utilities/crypt.js","name":"config","original":{"line":14,"column":35},"generated":{"line":2,"column":634}},{"source":"utilities/crypt.js","name":"ADDRESS_PREFIX","original":{"line":14,"column":42},"generated":{"line":2,"column":641}},{"source":"utilities/crypt.js","original":{"line":14,"column":59},"generated":{"line":2,"column":657}},{"source":"utilities/crypt.js","original":{"line":14,"column":59},"generated":{"line":2,"column":664}},{"source":"utilities/crypt.js","name":"byteArrayToHex","original":{"line":14,"column":64},"generated":{"line":2,"column":669}},{"source":"utilities/crypt.js","name":"pair","original":{"line":14,"column":79},"generated":{"line":2,"column":684}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":14,"column":84},"generated":{"line":2,"column":686}},{"source":"utilities/crypt.js","name":"keys","original":{"line":15,"column":8},"generated":{"line":2,"column":698}},{"source":"utilities/crypt.js","name":"privateKey","original":{"line":15,"column":13},"generated":{"line":2,"column":700}},{"source":"utilities/crypt.js","name":"global","original":{"line":15,"column":29},"generated":{"line":2,"column":711}},{"source":"utilities/crypt.js","name":"global","original":{"line":15,"column":29},"generated":{"line":2,"column":714}},{"source":"utilities/crypt.js","name":"global","original":{"line":15,"column":29},"generated":{"line":2,"column":721}},{"source":"utilities/crypt.js","name":"config","original":{"line":15,"column":36},"generated":{"line":2,"column":723}},{"source":"utilities/crypt.js","name":"ADDRESS_PREFIX","original":{"line":15,"column":43},"generated":{"line":2,"column":730}},{"source":"utilities/crypt.js","original":{"line":15,"column":60},"generated":{"line":2,"column":746}},{"source":"utilities/crypt.js","original":{"line":15,"column":60},"generated":{"line":2,"column":753}},{"source":"utilities/crypt.js","name":"byteArrayToHex","original":{"line":15,"column":65},"generated":{"line":2,"column":758}},{"source":"utilities/crypt.js","name":"pair","original":{"line":15,"column":80},"generated":{"line":2,"column":773}},{"source":"utilities/crypt.js","name":"secretKey","original":{"line":15,"column":85},"generated":{"line":2,"column":775}},{"source":"utilities/crypt.js","name":"keys","original":{"line":16,"column":15},"generated":{"line":2,"column":787}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":791}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":792}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":796}},{"source":"utilities/crypt.js","original":{"line":19,"column":4},"generated":{"line":2,"column":804}},{"source":"utilities/crypt.js","original":{"line":19,"column":4},"generated":{"line":2,"column":810}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":20,"column":15},"generated":{"line":2,"column":821}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":20,"column":15},"generated":{"line":2,"column":828}},{"source":"utilities/crypt.js","name":"randomBytes","original":{"line":20,"column":20},"generated":{"line":2,"column":830}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":20,"column":32},"generated":{"line":2,"column":842}},{"source":"utilities/crypt.js","name":"secretbox","original":{"line":20,"column":37},"generated":{"line":2,"column":844}},{"source":"utilities/crypt.js","name":"nonceLength","original":{"line":20,"column":47},"generated":{"line":2,"column":854}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":869}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":870}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":874}},{"source":"utilities/crypt.js","original":{"line":23,"column":4},"generated":{"line":2,"column":881}},{"source":"utilities/crypt.js","original":{"line":23,"column":4},"generated":{"line":2,"column":887}},{"source":"utilities/crypt.js","original":{"line":23,"column":37},"generated":{"line":2,"column":896}},{"source":"utilities/crypt.js","name":"payload","original":{"line":23,"column":17},"generated":{"line":2,"column":899}},{"source":"utilities/crypt.js","name":"payload","original":{"line":23,"column":17},"generated":{"line":2,"column":903}},{"source":"utilities/crypt.js","name":"payload","original":{"line":23,"column":17},"generated":{"line":2,"column":905}},{"source":"utilities/crypt.js","name":"payload","original":{"line":23,"column":17},"generated":{"line":2,"column":907}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":23,"column":26},"generated":{"line":2,"column":915}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":23,"column":26},"generated":{"line":2,"column":917}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":23,"column":26},"generated":{"line":2,"column":919}},{"source":"utilities/crypt.js","original":{"line":24,"column":30},"generated":{"line":2,"column":929}},{"source":"utilities/crypt.js","name":"payload","original":{"line":24,"column":18},"generated":{"line":2,"column":946}},{"source":"utilities/crypt.js","name":"payload","original":{"line":25,"column":12},"generated":{"line":2,"column":950}},{"source":"utilities/crypt.js","name":"JSON","original":{"line":25,"column":22},"generated":{"line":2,"column":952}},{"source":"utilities/crypt.js","name":"stringify","original":{"line":25,"column":27},"generated":{"line":2,"column":957}},{"source":"utilities/crypt.js","name":"payload","original":{"line":25,"column":37},"generated":{"line":2,"column":967}},{"source":"utilities/crypt.js","name":"result","original":{"line":27,"column":12},"generated":{"line":2,"column":971}},{"source":"utilities/crypt.js","name":"messageUint8","original":{"line":27,"column":25},"generated":{"line":2,"column":975}},{"source":"utilities/crypt.js","name":"hash","original":{"line":27,"column":39},"generated":{"line":2,"column":977}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":27,"column":45},"generated":{"line":2,"column":979}},{"source":"utilities/crypt.js","name":"key","original":{"line":27,"column":52},"generated":{"line":2,"column":981}},{"source":"utilities/crypt.js","name":"signature","original":{"line":27,"column":57},"generated":{"line":2,"column":983}},{"source":"utilities/crypt.js","name":"result","original":{"line":27,"column":12},"generated":{"line":2,"column":985}},{"source":"utilities/crypt.js","original":{"line":27,"column":21},"generated":{"line":2,"column":987}},{"source":"utilities/crypt.js","original":{"line":28,"column":11},"generated":{"line":2,"column":990}},{"source":"utilities/crypt.js","name":"messageUint8","original":{"line":29,"column":12},"generated":{"line":2,"column":994}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":29,"column":27},"generated":{"line":2,"column":996}},{"source":"utilities/crypt.js","name":"decodeUTF8","original":{"line":29,"column":32},"generated":{"line":2,"column":998}},{"source":"utilities/crypt.js","name":"payload","original":{"line":29,"column":43},"generated":{"line":2,"column":1009}},{"source":"utilities/crypt.js","name":"hash","original":{"line":30,"column":12},"generated":{"line":2,"column":1012}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":30,"column":19},"generated":{"line":2,"column":1014}},{"source":"utilities/crypt.js","name":"hash","original":{"line":30,"column":24},"generated":{"line":2,"column":1016}},{"source":"utilities/crypt.js","name":"messageUint8","original":{"line":30,"column":29},"generated":{"line":2,"column":1021}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":31,"column":12},"generated":{"line":2,"column":1024}},{"source":"utilities/crypt.js","original":{"line":31,"column":20},"generated":{"line":2,"column":1026}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":31,"column":25},"generated":{"line":2,"column":1031}},{"source":"utilities/crypt.js","name":"key","original":{"line":32,"column":12},"generated":{"line":2,"column":1039}},{"source":"utilities/crypt.js","original":{"line":32,"column":18},"generated":{"line":2,"column":1041}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":32,"column":23},"generated":{"line":2,"column":1046}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":32,"column":38},"generated":{"line":2,"column":1061}},{"source":"utilities/crypt.js","name":"signature","original":{"line":33,"column":12},"generated":{"line":2,"column":1064}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":33,"column":24},"generated":{"line":2,"column":1066}},{"source":"utilities/crypt.js","name":"secretbox","original":{"line":33,"column":29},"generated":{"line":2,"column":1068}},{"source":"utilities/crypt.js","name":"hash","original":{"line":33,"column":39},"generated":{"line":2,"column":1078}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":33,"column":45},"generated":{"line":2,"column":1080}},{"source":"utilities/crypt.js","name":"key","original":{"line":33,"column":52},"generated":{"line":2,"column":1082}},{"source":"utilities/crypt.js","original":{"line":34,"column":9},"generated":{"line":2,"column":1085}},{"source":"utilities/crypt.js","name":"error","original":{"line":34,"column":15},"generated":{"line":2,"column":1091}},{"source":"utilities/crypt.js","name":"console","original":{"line":35,"column":12},"generated":{"line":2,"column":1094}},{"source":"utilities/crypt.js","name":"log","original":{"line":35,"column":20},"generated":{"line":2,"column":1102}},{"source":"utilities/crypt.js","name":"error","original":{"line":35,"column":24},"generated":{"line":2,"column":1106}},{"source":"utilities/crypt.js","name":"result","original":{"line":40,"column":15},"generated":{"line":2,"column":1109}},{"source":"utilities/crypt.js","name":"result","original":{"line":38,"column":8},"generated":{"line":2,"column":1116}},{"source":"utilities/crypt.js","name":"signature","original":{"line":38,"column":15},"generated":{"line":2,"column":1118}},{"source":"utilities/crypt.js","original":{"line":38,"column":27},"generated":{"line":2,"column":1128}},{"source":"utilities/crypt.js","name":"byteArrayToHex","original":{"line":38,"column":32},"generated":{"line":2,"column":1133}},{"source":"utilities/crypt.js","name":"signature","original":{"line":38,"column":47},"generated":{"line":2,"column":1148}},{"source":"utilities/crypt.js","name":"result","original":{"line":39,"column":8},"generated":{"line":2,"column":1151}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":39,"column":15},"generated":{"line":2,"column":1153}},{"source":"utilities/crypt.js","original":{"line":39,"column":23},"generated":{"line":2,"column":1159}},{"source":"utilities/crypt.js","name":"byteArrayToHex","original":{"line":39,"column":28},"generated":{"line":2,"column":1164}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":39,"column":43},"generated":{"line":2,"column":1179}},{"source":"utilities/crypt.js","name":"result","original":{"line":40,"column":15},"generated":{"line":2,"column":1182}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1186}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1187}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1191}},{"source":"utilities/crypt.js","original":{"line":43,"column":4},"generated":{"line":2,"column":1200}},{"source":"utilities/crypt.js","original":{"line":43,"column":4},"generated":{"line":2,"column":1206}},{"source":"utilities/crypt.js","original":{"line":43,"column":48},"generated":{"line":2,"column":1215}},{"source":"utilities/crypt.js","name":"signature","original":{"line":43,"column":19},"generated":{"line":2,"column":1218}},{"source":"utilities/crypt.js","name":"signature","original":{"line":43,"column":19},"generated":{"line":2,"column":1222}},{"source":"utilities/crypt.js","name":"signature","original":{"line":43,"column":19},"generated":{"line":2,"column":1224}},{"source":"utilities/crypt.js","name":"signature","original":{"line":43,"column":19},"generated":{"line":2,"column":1226}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":43,"column":30},"generated":{"line":2,"column":1236}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":43,"column":30},"generated":{"line":2,"column":1238}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":43,"column":30},"generated":{"line":2,"column":1240}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":43,"column":37},"generated":{"line":2,"column":1246}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":43,"column":37},"generated":{"line":2,"column":1248}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":43,"column":37},"generated":{"line":2,"column":1250}},{"source":"utilities/crypt.js","name":"valid","original":{"line":44,"column":12},"generated":{"line":2,"column":1260}},{"source":"utilities/crypt.js","original":{"line":44,"column":20},"generated":{"line":2,"column":1263}},{"source":"utilities/crypt.js","original":{"line":45,"column":11},"generated":{"line":2,"column":1265}},{"source":"utilities/crypt.js","name":"nonceByte","original":{"line":46,"column":16},"generated":{"line":2,"column":1269}},{"source":"utilities/crypt.js","name":"nonceByte","original":{"line":46,"column":16},"generated":{"line":2,"column":1273}},{"source":"utilities/crypt.js","original":{"line":46,"column":28},"generated":{"line":2,"column":1275}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":46,"column":33},"generated":{"line":2,"column":1280}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":46,"column":48},"generated":{"line":2,"column":1295}},{"source":"utilities/crypt.js","name":"signatureByte","original":{"line":47,"column":16},"generated":{"line":2,"column":1298}},{"source":"utilities/crypt.js","original":{"line":47,"column":32},"generated":{"line":2,"column":1300}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":47,"column":37},"generated":{"line":2,"column":1305}},{"source":"utilities/crypt.js","name":"signature","original":{"line":47,"column":52},"generated":{"line":2,"column":1320}},{"source":"utilities/crypt.js","name":"keyByte","original":{"line":48,"column":16},"generated":{"line":2,"column":1323}},{"source":"utilities/crypt.js","original":{"line":48,"column":26},"generated":{"line":2,"column":1325}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":48,"column":31},"generated":{"line":2,"column":1330}},{"source":"utilities/crypt.js","name":"publicKey","original":{"line":48,"column":46},"generated":{"line":2,"column":1345}},{"source":"utilities/crypt.js","name":"valid","original":{"line":49,"column":12},"generated":{"line":2,"column":1348}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":49,"column":20},"generated":{"line":2,"column":1350}},{"source":"utilities/crypt.js","name":"secretbox","original":{"line":49,"column":25},"generated":{"line":2,"column":1352}},{"source":"utilities/crypt.js","name":"open","original":{"line":49,"column":35},"generated":{"line":2,"column":1362}},{"source":"utilities/crypt.js","name":"signatureByte","original":{"line":49,"column":40},"generated":{"line":2,"column":1367}},{"source":"utilities/crypt.js","name":"nonceByte","original":{"line":49,"column":55},"generated":{"line":2,"column":1369}},{"source":"utilities/crypt.js","name":"keyByte","original":{"line":49,"column":66},"generated":{"line":2,"column":1371}},{"source":"utilities/crypt.js","original":{"line":50,"column":9},"generated":{"line":2,"column":1374}},{"source":"utilities/crypt.js","name":"error","original":{"line":50,"column":15},"generated":{"line":2,"column":1380}},{"source":"utilities/crypt.js","original":{"line":51,"column":19},"generated":{"line":2,"column":1383}},{"source":"utilities/crypt.js","original":{"line":51,"column":19},"generated":{"line":2,"column":1390}},{"source":"utilities/crypt.js","name":"valid","original":{"line":54,"column":11},"generated":{"line":2,"column":1392}},{"source":"utilities/crypt.js","original":{"line":54,"column":21},"generated":{"line":2,"column":1399}},{"source":"utilities/crypt.js","name":"valid","original":{"line":54,"column":11},"generated":{"line":2,"column":1403}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1407}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1408}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1412}},{"source":"utilities/crypt.js","original":{"line":58,"column":4},"generated":{"line":2,"column":1422}},{"source":"utilities/crypt.js","original":{"line":58,"column":4},"generated":{"line":2,"column":1428}},{"source":"utilities/crypt.js","name":"payload","original":{"line":58,"column":19},"generated":{"line":2,"column":1437}},{"source":"utilities/crypt.js","name":"receiver_public_key","original":{"line":58,"column":28},"generated":{"line":2,"column":1439}},{"source":"utilities/crypt.js","name":"sender_private_key","original":{"line":58,"column":49},"generated":{"line":2,"column":1441}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":59,"column":12},"generated":{"line":2,"column":1444}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":59,"column":12},"generated":{"line":2,"column":1448}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":59,"column":20},"generated":{"line":2,"column":1450}},{"source":"utilities/crypt.js","name":"randomBytes","original":{"line":59,"column":25},"generated":{"line":2,"column":1452}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":59,"column":37},"generated":{"line":2,"column":1464}},{"source":"utilities/crypt.js","name":"secretbox","original":{"line":59,"column":42},"generated":{"line":2,"column":1466}},{"source":"utilities/crypt.js","name":"nonceLength","original":{"line":59,"column":52},"generated":{"line":2,"column":1476}},{"source":"utilities/crypt.js","name":"key","original":{"line":60,"column":12},"generated":{"line":2,"column":1489}},{"source":"utilities/crypt.js","original":{"line":60,"column":18},"generated":{"line":2,"column":1491}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":60,"column":23},"generated":{"line":2,"column":1496}},{"source":"utilities/crypt.js","name":"receiver_public_key","original":{"line":60,"column":38},"generated":{"line":2,"column":1511}},{"source":"utilities/crypt.js","name":"secret","original":{"line":61,"column":12},"generated":{"line":2,"column":1514}},{"source":"utilities/crypt.js","original":{"line":61,"column":21},"generated":{"line":2,"column":1516}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":61,"column":26},"generated":{"line":2,"column":1521}},{"source":"utilities/crypt.js","name":"sender_private_key","original":{"line":61,"column":41},"generated":{"line":2,"column":1536}},{"source":"utilities/crypt.js","name":"messageUint8","original":{"line":62,"column":12},"generated":{"line":2,"column":1539}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":62,"column":27},"generated":{"line":2,"column":1541}},{"source":"utilities/crypt.js","name":"decodeUTF8","original":{"line":62,"column":32},"generated":{"line":2,"column":1543}},{"source":"utilities/crypt.js","name":"payload","original":{"line":62,"column":43},"generated":{"line":2,"column":1554}},{"source":"utilities/crypt.js","name":"encrypted","original":{"line":63,"column":12},"generated":{"line":2,"column":1557}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":63,"column":24},"generated":{"line":2,"column":1559}},{"source":"utilities/crypt.js","name":"box","original":{"line":63,"column":29},"generated":{"line":2,"column":1561}},{"source":"utilities/crypt.js","name":"messageUint8","original":{"line":63,"column":33},"generated":{"line":2,"column":1565}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":63,"column":47},"generated":{"line":2,"column":1567}},{"source":"utilities/crypt.js","name":"key","original":{"line":63,"column":54},"generated":{"line":2,"column":1569}},{"source":"utilities/crypt.js","name":"secret","original":{"line":63,"column":59},"generated":{"line":2,"column":1571}},{"source":"utilities/crypt.js","name":"encMessage","original":{"line":64,"column":12},"generated":{"line":2,"column":1574}},{"source":"utilities/crypt.js","original":{"line":64,"column":25},"generated":{"line":2,"column":1576}},{"source":"utilities/crypt.js","name":"Uint8Array","original":{"line":64,"column":29},"generated":{"line":2,"column":1580}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":64,"column":40},"generated":{"line":2,"column":1591}},{"source":"utilities/crypt.js","name":"length","original":{"line":64,"column":46},"generated":{"line":2,"column":1593}},{"source":"utilities/crypt.js","name":"encrypted","original":{"line":64,"column":55},"generated":{"line":2,"column":1600}},{"source":"utilities/crypt.js","name":"length","original":{"line":64,"column":65},"generated":{"line":2,"column":1602}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":67,"column":15},"generated":{"line":2,"column":1610}},{"source":"utilities/crypt.js","name":"encMessage","original":{"line":65,"column":8},"generated":{"line":2,"column":1617}},{"source":"utilities/crypt.js","name":"set","original":{"line":65,"column":19},"generated":{"line":2,"column":1619}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":65,"column":23},"generated":{"line":2,"column":1623}},{"source":"utilities/crypt.js","name":"encMessage","original":{"line":66,"column":8},"generated":{"line":2,"column":1626}},{"source":"utilities/crypt.js","name":"set","original":{"line":66,"column":19},"generated":{"line":2,"column":1628}},{"source":"utilities/crypt.js","name":"encrypted","original":{"line":66,"column":23},"generated":{"line":2,"column":1632}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":66,"column":34},"generated":{"line":2,"column":1634}},{"source":"utilities/crypt.js","name":"length","original":{"line":66,"column":40},"generated":{"line":2,"column":1636}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":67,"column":15},"generated":{"line":2,"column":1644}},{"source":"utilities/crypt.js","name":"encodeBase64","original":{"line":67,"column":20},"generated":{"line":2,"column":1646}},{"source":"utilities/crypt.js","name":"encMessage","original":{"line":67,"column":33},"generated":{"line":2,"column":1659}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1664}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1665}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1669}},{"source":"utilities/crypt.js","original":{"line":70,"column":4},"generated":{"line":2,"column":1679}},{"source":"utilities/crypt.js","original":{"line":70,"column":4},"generated":{"line":2,"column":1685}},{"source":"utilities/crypt.js","name":"emsg","original":{"line":70,"column":19},"generated":{"line":2,"column":1694}},{"source":"utilities/crypt.js","name":"receiver_private_key","original":{"line":70,"column":25},"generated":{"line":2,"column":1696}},{"source":"utilities/crypt.js","name":"sender_public_key","original":{"line":70,"column":47},"generated":{"line":2,"column":1698}},{"source":"utilities/crypt.js","name":"msgDecoded","original":{"line":71,"column":12},"generated":{"line":2,"column":1701}},{"source":"utilities/crypt.js","name":"msgDecoded","original":{"line":71,"column":12},"generated":{"line":2,"column":1705}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":71,"column":25},"generated":{"line":2,"column":1707}},{"source":"utilities/crypt.js","name":"decodeBase64","original":{"line":71,"column":30},"generated":{"line":2,"column":1709}},{"source":"utilities/crypt.js","name":"emsg","original":{"line":71,"column":43},"generated":{"line":2,"column":1722}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":72,"column":12},"generated":{"line":2,"column":1725}},{"source":"utilities/crypt.js","name":"msgDecoded","original":{"line":72,"column":20},"generated":{"line":2,"column":1727}},{"source":"utilities/crypt.js","name":"slice","original":{"line":72,"column":31},"generated":{"line":2,"column":1729}},{"source":"utilities/crypt.js","original":{"line":72,"column":37},"generated":{"line":2,"column":1735}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":72,"column":40},"generated":{"line":2,"column":1737}},{"source":"utilities/crypt.js","name":"box","original":{"line":72,"column":45},"generated":{"line":2,"column":1739}},{"source":"utilities/crypt.js","name":"nonceLength","original":{"line":72,"column":49},"generated":{"line":2,"column":1743}},{"source":"utilities/crypt.js","name":"message","original":{"line":73,"column":12},"generated":{"line":2,"column":1756}},{"source":"utilities/crypt.js","name":"msgDecoded","original":{"line":73,"column":22},"generated":{"line":2,"column":1758}},{"source":"utilities/crypt.js","name":"slice","original":{"line":73,"column":33},"generated":{"line":2,"column":1760}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":73,"column":39},"generated":{"line":2,"column":1766}},{"source":"utilities/crypt.js","name":"box","original":{"line":73,"column":44},"generated":{"line":2,"column":1768}},{"source":"utilities/crypt.js","name":"nonceLength","original":{"line":73,"column":48},"generated":{"line":2,"column":1772}},{"source":"utilities/crypt.js","name":"emsg","original":{"line":73,"column":61},"generated":{"line":2,"column":1784}},{"source":"utilities/crypt.js","name":"length","original":{"line":73,"column":66},"generated":{"line":2,"column":1786}},{"source":"utilities/crypt.js","name":"key","original":{"line":74,"column":12},"generated":{"line":2,"column":1794}},{"source":"utilities/crypt.js","original":{"line":74,"column":18},"generated":{"line":2,"column":1796}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":74,"column":23},"generated":{"line":2,"column":1801}},{"source":"utilities/crypt.js","name":"receiver_private_key","original":{"line":74,"column":38},"generated":{"line":2,"column":1816}},{"source":"utilities/crypt.js","name":"secret","original":{"line":75,"column":12},"generated":{"line":2,"column":1819}},{"source":"utilities/crypt.js","original":{"line":75,"column":21},"generated":{"line":2,"column":1821}},{"source":"utilities/crypt.js","name":"hexToByteArray","original":{"line":75,"column":26},"generated":{"line":2,"column":1826}},{"source":"utilities/crypt.js","name":"sender_public_key","original":{"line":75,"column":41},"generated":{"line":2,"column":1841}},{"source":"utilities/crypt.js","name":"decrypted","original":{"line":76,"column":12},"generated":{"line":2,"column":1844}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":76,"column":24},"generated":{"line":2,"column":1846}},{"source":"utilities/crypt.js","name":"box","original":{"line":76,"column":29},"generated":{"line":2,"column":1848}},{"source":"utilities/crypt.js","name":"open","original":{"line":76,"column":33},"generated":{"line":2,"column":1852}},{"source":"utilities/crypt.js","name":"message","original":{"line":76,"column":38},"generated":{"line":2,"column":1857}},{"source":"utilities/crypt.js","name":"nonce","original":{"line":76,"column":47},"generated":{"line":2,"column":1859}},{"source":"utilities/crypt.js","name":"secret","original":{"line":76,"column":54},"generated":{"line":2,"column":1861}},{"source":"utilities/crypt.js","name":"key","original":{"line":76,"column":62},"generated":{"line":2,"column":1863}},{"source":"utilities/crypt.js","original":{"line":77,"column":12},"generated":{"line":2,"column":1866}},{"source":"utilities/crypt.js","name":"decrypted","original":{"line":77,"column":13},"generated":{"line":2,"column":1870}},{"source":"utilities/crypt.js","original":{"line":78,"column":18},"generated":{"line":2,"column":1872}},{"source":"utilities/crypt.js","original":{"line":78,"column":18},"generated":{"line":2,"column":1878}},{"source":"utilities/crypt.js","name":"Error","original":{"line":78,"column":22},"generated":{"line":2,"column":1882}},{"source":"utilities/crypt.js","original":{"line":78,"column":28},"generated":{"line":2,"column":1888}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":80,"column":15},"generated":{"line":2,"column":1917}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":80,"column":15},"generated":{"line":2,"column":1924}},{"source":"utilities/crypt.js","name":"encodeUTF8","original":{"line":80,"column":20},"generated":{"line":2,"column":1926}},{"source":"utilities/crypt.js","name":"decrypted","original":{"line":80,"column":31},"generated":{"line":2,"column":1937}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1942}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1943}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":1947}},{"source":"utilities/crypt.js","original":{"line":83,"column":4},"generated":{"line":2,"column":1964}},{"source":"utilities/crypt.js","original":{"line":83,"column":4},"generated":{"line":2,"column":1970}},{"source":"utilities/crypt.js","name":"byteArray","original":{"line":83,"column":26},"generated":{"line":2,"column":1979}},{"source":"utilities/crypt.js","name":"Array","original":{"line":84,"column":15},"generated":{"line":2,"column":1982}},{"source":"utilities/crypt.js","name":"Array","original":{"line":84,"column":15},"generated":{"line":2,"column":1989}},{"source":"utilities/crypt.js","name":"prototype","original":{"line":84,"column":21},"generated":{"line":2,"column":1995}},{"source":"utilities/crypt.js","name":"map","original":{"line":84,"column":31},"generated":{"line":2,"column":2005}},{"source":"utilities/crypt.js","name":"call","original":{"line":84,"column":35},"generated":{"line":2,"column":2009}},{"source":"utilities/crypt.js","name":"byteArray","original":{"line":84,"column":40},"generated":{"line":2,"column":2014}},{"source":"utilities/crypt.js","original":{"line":84,"column":51},"generated":{"line":2,"column":2016}},{"source":"utilities/crypt.js","name":"byte","original":{"line":84,"column":60},"generated":{"line":2,"column":2025}},{"source":"utilities/crypt.js","original":{"line":85,"column":17},"generated":{"line":2,"column":2028}},{"source":"utilities/crypt.js","original":{"line":85,"column":18},"generated":{"line":2,"column":2035}},{"source":"utilities/crypt.js","original":{"line":85,"column":32},"generated":{"line":2,"column":2040}},{"source":"utilities/crypt.js","name":"byte","original":{"line":85,"column":25},"generated":{"line":2,"column":2044}},{"source":"utilities/crypt.js","name":"toString","original":{"line":85,"column":38},"generated":{"line":2,"column":2047}},{"source":"utilities/crypt.js","original":{"line":85,"column":47},"generated":{"line":2,"column":2056}},{"source":"utilities/crypt.js","name":"slice","original":{"line":85,"column":52},"generated":{"line":2,"column":2061}},{"source":"utilities/crypt.js","original":{"line":85,"column":59},"generated":{"line":2,"column":2068}},{"source":"utilities/crypt.js","name":"join","original":{"line":86,"column":11},"generated":{"line":2,"column":2073}},{"source":"utilities/crypt.js","original":{"line":86,"column":16},"generated":{"line":2,"column":2078}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2084}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2085}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2089}},{"source":"utilities/crypt.js","original":{"line":89,"column":4},"generated":{"line":2,"column":2106}},{"source":"utilities/crypt.js","original":{"line":89,"column":4},"generated":{"line":2,"column":2112}},{"source":"utilities/crypt.js","name":"hexString","original":{"line":89,"column":26},"generated":{"line":2,"column":2121}},{"source":"utilities/crypt.js","name":"result","original":{"line":90,"column":12},"generated":{"line":2,"column":2124}},{"source":"utilities/crypt.js","name":"result","original":{"line":90,"column":12},"generated":{"line":2,"column":2128}},{"source":"utilities/crypt.js","original":{"line":90,"column":21},"generated":{"line":2,"column":2130}},{"source":"utilities/crypt.js","name":"hexString","original":{"line":91,"column":11},"generated":{"line":2,"column":2133}},{"source":"utilities/crypt.js","name":"substr","original":{"line":91,"column":21},"generated":{"line":2,"column":2135}},{"source":"utilities/crypt.js","original":{"line":91,"column":28},"generated":{"line":2,"column":2142}},{"source":"utilities/crypt.js","name":"global","original":{"line":91,"column":30},"generated":{"line":2,"column":2144}},{"source":"utilities/crypt.js","name":"config","original":{"line":91,"column":37},"generated":{"line":2,"column":2146}},{"source":"utilities/crypt.js","name":"ADDRESS_PREFIX","original":{"line":91,"column":44},"generated":{"line":2,"column":2153}},{"source":"utilities/crypt.js","name":"length","original":{"line":91,"column":59},"generated":{"line":2,"column":2168}},{"source":"utilities/crypt.js","name":"global","original":{"line":91,"column":71},"generated":{"line":2,"column":2178}},{"source":"utilities/crypt.js","name":"config","original":{"line":91,"column":78},"generated":{"line":2,"column":2180}},{"source":"utilities/crypt.js","name":"ADDRESS_PREFIX","original":{"line":91,"column":85},"generated":{"line":2,"column":2187}},{"source":"utilities/crypt.js","name":"hexString","original":{"line":92,"column":12},"generated":{"line":2,"column":2204}},{"source":"utilities/crypt.js","name":"hexString","original":{"line":92,"column":24},"generated":{"line":2,"column":2206}},{"source":"utilities/crypt.js","name":"substr","original":{"line":92,"column":34},"generated":{"line":2,"column":2208}},{"source":"utilities/crypt.js","name":"global","original":{"line":92,"column":41},"generated":{"line":2,"column":2215}},{"source":"utilities/crypt.js","name":"config","original":{"line":92,"column":48},"generated":{"line":2,"column":2217}},{"source":"utilities/crypt.js","name":"ADDRESS_PREFIX","original":{"line":92,"column":55},"generated":{"line":2,"column":2224}},{"source":"utilities/crypt.js","name":"length","original":{"line":92,"column":70},"generated":{"line":2,"column":2239}},{"source":"utilities/crypt.js","original":{"line":94,"column":13},"generated":{"line":2,"column":2248}},{"source":"utilities/crypt.js","original":{"line":94,"column":13},"generated":{"line":2,"column":2252}},{"source":"utilities/crypt.js","name":"i","original":{"line":94,"column":17},"generated":{"line":2,"column":2256}},{"source":"utilities/crypt.js","original":{"line":94,"column":21},"generated":{"line":2,"column":2258}},{"source":"utilities/crypt.js","name":"i","original":{"line":94,"column":24},"generated":{"line":2,"column":2260}},{"source":"utilities/crypt.js","name":"hexString","original":{"line":94,"column":28},"generated":{"line":2,"column":2262}},{"source":"utilities/crypt.js","name":"length","original":{"line":94,"column":38},"generated":{"line":2,"column":2264}},{"source":"utilities/crypt.js","name":"i","original":{"line":94,"column":46},"generated":{"line":2,"column":2271}},{"source":"utilities/crypt.js","original":{"line":94,"column":51},"generated":{"line":2,"column":2274}},{"source":"utilities/crypt.js","name":"result","original":{"line":95,"column":12},"generated":{"line":2,"column":2276}},{"source":"utilities/crypt.js","name":"push","original":{"line":95,"column":19},"generated":{"line":2,"column":2278}},{"source":"utilities/crypt.js","name":"parseInt","original":{"line":95,"column":24},"generated":{"line":2,"column":2283}},{"source":"utilities/crypt.js","name":"hexString","original":{"line":95,"column":33},"generated":{"line":2,"column":2292}},{"source":"utilities/crypt.js","name":"substr","original":{"line":95,"column":43},"generated":{"line":2,"column":2294}},{"source":"utilities/crypt.js","name":"i","original":{"line":95,"column":50},"generated":{"line":2,"column":2301}},{"source":"utilities/crypt.js","original":{"line":95,"column":53},"generated":{"line":2,"column":2303}},{"source":"utilities/crypt.js","original":{"line":95,"column":57},"generated":{"line":2,"column":2306}},{"source":"utilities/crypt.js","original":{"line":97,"column":15},"generated":{"line":2,"column":2311}},{"source":"utilities/crypt.js","original":{"line":97,"column":15},"generated":{"line":2,"column":2318}},{"source":"utilities/crypt.js","name":"Uint8Array","original":{"line":97,"column":19},"generated":{"line":2,"column":2322}},{"source":"utilities/crypt.js","name":"result","original":{"line":97,"column":30},"generated":{"line":2,"column":2333}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2338}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2339}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2343}},{"source":"utilities/crypt.js","original":{"line":100,"column":4},"generated":{"line":2,"column":2361}},{"source":"utilities/crypt.js","original":{"line":100,"column":4},"generated":{"line":2,"column":2367}},{"source":"utilities/crypt.js","name":"key","original":{"line":100,"column":27},"generated":{"line":2,"column":2376}},{"source":"utilities/crypt.js","original":{"line":101,"column":12},"generated":{"line":2,"column":2379}},{"source":"utilities/crypt.js","name":"k","original":{"line":102,"column":16},"generated":{"line":2,"column":2383}},{"source":"utilities/crypt.js","name":"k","original":{"line":102,"column":16},"generated":{"line":2,"column":2387}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":102,"column":20},"generated":{"line":2,"column":2389}},{"source":"utilities/crypt.js","name":"decodeBase64","original":{"line":102,"column":25},"generated":{"line":2,"column":2391}},{"source":"utilities/crypt.js","name":"key","original":{"line":102,"column":38},"generated":{"line":2,"column":2404}},{"source":"utilities/crypt.js","name":"k","original":{"line":103,"column":16},"generated":{"line":2,"column":2407}},{"source":"utilities/crypt.js","name":"k","original":{"line":103,"column":16},"generated":{"line":2,"column":2414}},{"source":"utilities/crypt.js","name":"length","original":{"line":103,"column":18},"generated":{"line":2,"column":2416}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":103,"column":28},"generated":{"line":2,"column":2424}},{"source":"utilities/crypt.js","name":"box","original":{"line":103,"column":33},"generated":{"line":2,"column":2426}},{"source":"utilities/crypt.js","name":"publicKeyLength","original":{"line":103,"column":37},"generated":{"line":2,"column":2430}},{"source":"utilities/crypt.js","name":"error","original":{"line":104,"column":21},"generated":{"line":2,"column":2447}},{"source":"utilities/crypt.js","name":"error","original":{"line":104,"column":21},"generated":{"line":2,"column":2452}},{"source":"utilities/crypt.js","original":{"line":104,"column":27},"generated":{"line":2,"column":2458}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":104,"column":63},"generated":{"line":2,"column":2492}},{"source":"utilities/crypt.js","name":"box","original":{"line":104,"column":68},"generated":{"line":2,"column":2494}},{"source":"utilities/crypt.js","name":"publicKeyLength","original":{"line":104,"column":72},"generated":{"line":2,"column":2498}},{"source":"utilities/crypt.js","original":{"line":104,"column":90},"generated":{"line":2,"column":2514}},{"source":"utilities/crypt.js","original":{"line":105,"column":23},"generated":{"line":2,"column":2524}},{"source":"utilities/crypt.js","name":"k","original":{"line":107,"column":19},"generated":{"line":2,"column":2530}},{"source":"utilities/crypt.js","original":{"line":108,"column":10},"generated":{"line":2,"column":2532}},{"source":"utilities/crypt.js","name":"e","original":{"line":108,"column":16},"generated":{"line":2,"column":2538}},{"source":"utilities/crypt.js","original":{"line":110,"column":19},"generated":{"line":2,"column":2541}},{"source":"utilities/crypt.js","name":"error","original":{"line":109,"column":17},"generated":{"line":2,"column":2548}},{"source":"utilities/crypt.js","name":"error","original":{"line":109,"column":17},"generated":{"line":2,"column":2553}},{"source":"utilities/crypt.js","original":{"line":109,"column":23},"generated":{"line":2,"column":2559}},{"source":"utilities/crypt.js","original":{"line":110,"column":19},"generated":{"line":2,"column":2602}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2610}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2611}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2615}},{"source":"utilities/crypt.js","original":{"line":114,"column":4},"generated":{"line":2,"column":2633}},{"source":"utilities/crypt.js","original":{"line":114,"column":4},"generated":{"line":2,"column":2639}},{"source":"utilities/crypt.js","name":"key","original":{"line":114,"column":27},"generated":{"line":2,"column":2648}},{"source":"utilities/crypt.js","original":{"line":115,"column":12},"generated":{"line":2,"column":2651}},{"source":"utilities/crypt.js","name":"k","original":{"line":116,"column":16},"generated":{"line":2,"column":2655}},{"source":"utilities/crypt.js","name":"k","original":{"line":116,"column":16},"generated":{"line":2,"column":2659}},{"source":"utilities/crypt.js","name":"UTIL","original":{"line":116,"column":20},"generated":{"line":2,"column":2661}},{"source":"utilities/crypt.js","name":"decodeBase64","original":{"line":116,"column":25},"generated":{"line":2,"column":2663}},{"source":"utilities/crypt.js","name":"key","original":{"line":116,"column":38},"generated":{"line":2,"column":2676}},{"source":"utilities/crypt.js","name":"k","original":{"line":117,"column":16},"generated":{"line":2,"column":2679}},{"source":"utilities/crypt.js","name":"k","original":{"line":117,"column":16},"generated":{"line":2,"column":2686}},{"source":"utilities/crypt.js","name":"length","original":{"line":117,"column":18},"generated":{"line":2,"column":2688}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":117,"column":28},"generated":{"line":2,"column":2696}},{"source":"utilities/crypt.js","name":"box","original":{"line":117,"column":33},"generated":{"line":2,"column":2698}},{"source":"utilities/crypt.js","name":"secretKeyLength","original":{"line":117,"column":37},"generated":{"line":2,"column":2702}},{"source":"utilities/crypt.js","name":"error","original":{"line":118,"column":21},"generated":{"line":2,"column":2719}},{"source":"utilities/crypt.js","name":"error","original":{"line":118,"column":21},"generated":{"line":2,"column":2724}},{"source":"utilities/crypt.js","original":{"line":118,"column":27},"generated":{"line":2,"column":2730}},{"source":"utilities/crypt.js","name":"NACL","original":{"line":118,"column":63},"generated":{"line":2,"column":2764}},{"source":"utilities/crypt.js","name":"box","original":{"line":118,"column":68},"generated":{"line":2,"column":2766}},{"source":"utilities/crypt.js","name":"secretKeyLength","original":{"line":118,"column":72},"generated":{"line":2,"column":2770}},{"source":"utilities/crypt.js","original":{"line":118,"column":90},"generated":{"line":2,"column":2786}},{"source":"utilities/crypt.js","original":{"line":119,"column":23},"generated":{"line":2,"column":2796}},{"source":"utilities/crypt.js","name":"k","original":{"line":121,"column":19},"generated":{"line":2,"column":2802}},{"source":"utilities/crypt.js","original":{"line":122,"column":10},"generated":{"line":2,"column":2804}},{"source":"utilities/crypt.js","name":"e","original":{"line":122,"column":16},"generated":{"line":2,"column":2810}},{"source":"utilities/crypt.js","original":{"line":124,"column":19},"generated":{"line":2,"column":2813}},{"source":"utilities/crypt.js","name":"error","original":{"line":123,"column":17},"generated":{"line":2,"column":2820}},{"source":"utilities/crypt.js","name":"error","original":{"line":123,"column":17},"generated":{"line":2,"column":2825}},{"source":"utilities/crypt.js","original":{"line":123,"column":23},"generated":{"line":2,"column":2831}},{"source":"utilities/crypt.js","original":{"line":124,"column":19},"generated":{"line":2,"column":2874}},{"source":"utilities/crypt.js","original":{"line":132,"column":0},"generated":{"line":2,"column":2884}},{"source":"utilities/crypt.js","name":"Crypt","original":{"line":5,"column":6},"generated":{"line":2,"column":2886}},{"source":"utilities/crypt.js","name":"module","original":{"line":132,"column":0},"generated":{"line":2,"column":2889}},{"source":"utilities/crypt.js","name":"exports","original":{"line":132,"column":7},"generated":{"line":2,"column":2896}},{"source":"utilities/crypt.js","name":"Crypt","original":{"line":132,"column":17},"generated":{"line":2,"column":2904}}],"sources":{"utilities/crypt.js":"const CryptoJS = require('crypto-js');\nconst NACL = require('tweetnacl')\nconst UTIL = require('tweetnacl-util');\n\nclass Crypt {\n\n    static hash (payload) {\n        return CryptoJS.SHA384( JSON.stringify( payload) ).toString();\n    }\n\n    static create () {\n        let keys = {};\n        let pair = NACL.box.keyPair();\n        keys.publicKey = `${global.config.ADDRESS_PREFIX}${this.byteArrayToHex(pair.publicKey)}`;\n        keys.privateKey = `${global.config.ADDRESS_PREFIX}${this.byteArrayToHex(pair.secretKey)}`; \n        return keys;\n    }\n\n    static nonce(){\n        return NACL.randomBytes(NACL.secretbox.nonceLength);\n    }\n\n    static sign({payload, publicKey}){\n        if(typeof payload !== 'string'){\n            payload = JSON.stringify(payload)\n        }\n        let result = {}, messageUint8, hash, nonce, key, signature; \n        try{\n            messageUint8 = UTIL.decodeUTF8(payload);\n            hash = NACL.hash(messageUint8);\n            nonce = this.nonce();\n            key = this.hexToByteArray(publicKey)\n            signature = NACL.secretbox(hash, nonce, key)\n        }catch(error){\n            console.log(error)\n        //    throw new Error(error)\n        }\n        result.signature = this.byteArrayToHex(signature)\n        result.nonce = this.byteArrayToHex(nonce)\n        return result;\n    }\n\n    static verify({signature, nonce, publicKey}){\n        let valid = false;\n        try{\n            let nonceByte = this.hexToByteArray(nonce);\n            let signatureByte = this.hexToByteArray(signature);\n            let keyByte = this.hexToByteArray(publicKey);\n            valid = NACL.secretbox.open(signatureByte, nonceByte, keyByte)\n        }catch(error){\n            return false;\n        }\n        \n        if(valid !== false) return true;\n        return false; \n    }\n\n    static encrypt(payload, receiver_public_key, sender_private_key){\n        let nonce = NACL.randomBytes(NACL.secretbox.nonceLength);\n        let key = this.hexToByteArray(receiver_public_key);\n        let secret = this.hexToByteArray(sender_private_key);\n        let messageUint8 = UTIL.decodeUTF8(payload);\n        let encrypted = NACL.box(messageUint8, nonce, key, secret);\n        let encMessage = new Uint8Array(nonce.length + encrypted.length)\n        encMessage.set(nonce);\n        encMessage.set(encrypted, nonce.length);\n        return UTIL.encodeBase64(encMessage);\n    }\n\n    static decrypt(emsg, receiver_private_key, sender_public_key){\n        let msgDecoded = UTIL.decodeBase64(emsg)\n        let nonce = msgDecoded.slice(0, NACL.box.nonceLength);\n        let message = msgDecoded.slice(NACL.box.nonceLength, emsg.length);\n        let key = this.hexToByteArray(receiver_private_key)\n        let secret = this.hexToByteArray(sender_public_key)\n        let decrypted = NACL.box.open(message, nonce, secret, key)\n        if (!decrypted) {\n            throw new Error('Could not decrypt message');\n        }\n        return UTIL.encodeUTF8(decrypted);  \n    }\n\n    static byteArrayToHex(byteArray) {\n        return Array.prototype.map.call(byteArray, function(byte) {\n          return ('0' + (byte & 0xFF).toString(16)).slice(-2);\n        }).join('');\n    }\n\n    static hexToByteArray(hexString) {\n        var result = [];\n        if(hexString.substr(0,global.config.ADDRESS_PREFIX.length) === global.config.ADDRESS_PREFIX){\n            hexString = hexString.substr(global.config.ADDRESS_PREFIX.length)\n        }\n        for (var i = 0; i < hexString.length; i += 2) {\n            result.push(parseInt(hexString.substr(i, 2), 16));\n        }\n        return new Uint8Array(result);\n    }\n\n    static decodePublicKey(key){\n        try {\n            let k = UTIL.decodeBase64(key);\n            if (k.length != NACL.box.publicKeyLength) {\n                this.error('Bad public key length: must be ' + NACL.box.publicKeyLength + ' bytes');\n                return null;\n            }\n            return k;\n        } catch(e) {\n            this.error('Failed to decode public key from Base64');\n            return null;\n        }\n    }\n\n    static decodeSecretKey(key){\n        try {\n            let k = UTIL.decodeBase64(key);\n            if (k.length != NACL.box.secretKeyLength) {\n                this.error('Bad secret key length: must be ' + NACL.box.secretKeyLength + ' bytes');\n                return null;\n            }\n            return k;\n        } catch(e) {\n            this.error('Failed to decode secret key from Base64');\n            return null;\n        }\n    }\n\n\n\n}\n\nmodule.exports = Crypt;"},"lineCount":null}},"error":null,"hash":"8d0eaf165155a67ff25e0e47e1e3f26f","cacheData":{"env":{}}}